# GEp(5) GEM Front Tracker ROI Mapping Scripts

This repository contains tools and mapping files developed to support **Region of Interest (ROI)** selection
for the **GEM Front Tracker (FT)** in the **GEp-V** experiment at Jefferson Lab.

---

## Main Script

* `generate_ROI_APVlist.C`
  Maps each ECal bin to its corresponding set of GEM APVs using detector geometry, ROI definitions, and configuration databases.
  Outputs results to `EcalBinToAPVmap.txt`

---

## Visualization Tools

* `showGEMstripsHit_for_ecalbin.cpp`
  Visualizes the U and V strip activity across all GEM layers for a selected ECal bin, allowing validation of the ROI and APV assignments.

* `show_ecal_2Dcellmap.C`, `showgemhit_for_ecalbin.C` — Visual tools to display ECal cell maps and GEM hit patterns.

---

## Running Main Scripts

**Generate APV list for all bins:**

```bash
analyzer .x generate_ROI_APVlist.C
```

**Plot ROI superimposed on corresponding UV strips:**

```bash
analyzer .x showGEMstripsHit_for_ecalbin.cpp
```

You will be prompted to input ECal bin numbers (e.g., `10 11 12`) or press Enter to visualize all bins.
Then, select whether to export plots as PDFs or display them interactively.

---

## Helpful Tools

These scripts assist in ROI validation, performance estimation, and geometric visualization:

* `estimateROIreduction.cpp` — Computes the reduction in total strips/APVs per bin due to ROI-based readout.
* `print_gemhitpos_perecalbin.C`, `print_gemhitpos_perecalbin_new.C` — Print and plot GEM hit positions for specific ECal bins.

---

## Parsing and Mapping Scripts

* `GetchanMap.cpp` — Parses `db_sbs.gemFT.dat` and generates `chanMapAPVinfo.txt`, listing GEMId (module), axis, position, VTP crate, fiber, and ADC channel mappings.

* `chanMapAPVinfo.txt`, `StripAPVmap.txt` — Static maps generated by `GetchanMap` for converting between strip numbers and APV electronics identifiers.

* `GetGemInfoMap.cxx` — Core dependency for geometry: defines positions, strip angles, module sizes, strip counts, and number of APVs per module.

---

## Configuration and Reference Files

**Required files:**

* `db_FT_local.dat` — **Main static GEM database**. Used by all scripts to retrieve GEM module positions, dimensions, strip counts, and angles.

  > This file is periodically updated by replacing it with the contents of `db_sbs.gemFT.dat`, which is the working configuration. To reflect new or altered electronics connections (e.g., VTP crate, fiber, APV position), run `GetchanMap` on updated raw configurations and then overwrite `db_FT_local.dat`.

* `db_sbs.gemFT.dat` — Live configuration file for GEM modules. Used as a staging file for edits and reruns before copying into `db_FT_local.dat`.

* `ROI_GEP3_1.txt`, `ROI_GEP3_FT_1.txt` — ROI region files used to restrict GEM readout to relevant areas per ECal bin.

* `ecal_cell_table_gep_feb10.txt`, `ecalbin.h`, `ecalbin2.h` — Define the ECal bin structure and geometry.

* `EcalBinToAPVmap.txt` — Final output listing all APVs associated with each ECal bin.

* `outPhysicalStrips.txt` — Records U/V strip numbers used in each bin’s ROI, grouped by GEM module.

---

## Dependencies

The main scripts rely on the following project-specific source and header files:

* `DBread.h` — Reads and parses GEM configuration databases.
* `ROIread.h` — Loads ROI definitions for each ECal bin and GEM layer.
* `GEMModROItoStrips.h` — Converts ROI spatial bounds into physical strip ranges.
* `GetGemInfoMap.cxx` — Constructs the GEM module geometry map used by all tools.
* `showgemhit_for_ecalbin.C` — Visualization utility used for drawing GEM hit overlays.

These files must be present and consistent across all scripts for successful compilation and execution.

---
